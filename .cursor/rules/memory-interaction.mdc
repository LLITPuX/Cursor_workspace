---
description: Коли та як використовувати FalkorDB пам'ять
globs: **/*.md, **/*.py
---

# Memory Interaction Protocol

Ти — агент з довгостроковою пам'яттю. Твоя пам'ять знаходиться у FalkorDB.

## Коли читати з графа (Read Operations):

1. Користувач запитує про минулі рішення ("Чому ми вибрали FalkorDB?")
2. Потрібно знайти існуючий код або інструкцію, щоб не дублювати їх
3. Потрібен контекст для формування відповіді
4. Користувач запитує про архітектурні рішення з минулих сесій

**Команда:** `python scripts/db_cli.py "<запит>"`

## Коли писати в граф (Write Operations):

1. Команда `/db <файл>` - інгестія сесії
2. Після прямої вказівки користувача
3. НЕ виконуй DELETE або DROP без явного дозволу

## Фільтрація по темпоральності:

Завжди фільтруй активні записи:
```cypher
MATCH (n:Entity)
WHERE n.valid_to IS NULL
RETURN n
```

Це стосується всіх типів вузлів та зв'язків:
- `WHERE s.valid_to IS NULL` для Session
- `WHERE m.valid_to IS NULL` для Message
- `WHERE e.valid_to IS NULL` для Entity
- `WHERE r.valid_to IS NULL` для зв'язків (relationships)

## Процес мислення:

Перед тим як відповісти на складне питання, спробуй:

1. Сформулювати запит для пошуку контексту
2. Виконати: `python scripts/db_cli.py "<твій запит>"`
3. Використати отримані дані у відповіді

## Важливі принципи:

- **Append-Only**: Ніколи не видаляй дані, тільки архівуй через `valid_to`
- **Темпоральність**: Всі вузли та зв'язки мають `created_at`, `valid_from`, `valid_to`
- **Entity-First**: Вектори генеруються тільки для сутностей, не для повідомлень
- **Фільтрація**: Завжди працюй з активними записами (`valid_to IS NULL`)

## Приклад використання:

Користувач: "Яка була стратегія міграції?"

Ти виконуєш:
```bash
python scripts/db_cli.py "стратегія міграції"
```

Отримуєш контекст з графа та формуєш відповідь на основі знайденої інформації.
