# –ü—Ä–æ—Ç–æ–∫–æ–ª –ü–∞–º'—è—Ç—ñ (Memory Protocol)

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç —î —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—î—é –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞ (Cursor) —â–æ–¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –ø–∞–º'—è—Ç—ñ.

## üõ†Ô∏è –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ Neon MCP (Agent Capabilities)

–ê–≥–µ–Ω—Ç –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ (tools) —á–µ—Ä–µ–∑ Neon MCP —Å–µ—Ä–≤–µ—Ä. 
**–í–ê–ñ–õ–ò–í–û:** –Ø–∫—â–æ –≤–∏ –≤ —Ä–µ–∂–∏–º—ñ Ask Mode, —Ü—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –∞–ª–µ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∑–Ω–∞—Ç–∏ –ø—Ä–æ —ó—Ö —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–ª–∞–Ω—É–≤–∞—Ç–∏ —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

### –û—Å–Ω–æ–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:
1. **`run_sql`**: –í–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö SQL –∑–∞–ø–∏—Ç—ñ–≤.
   - *–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:* –ß–∏—Ç–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó, –ø–æ—à—É–∫ —Ñ–∞–∫—Ç—ñ–≤, –≤—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–∏—Ö —Å–ø–æ–≥–∞–¥—ñ–≤.
   - *–ü—Ä–∏–∫–ª–∞–¥:* `SELECT content FROM messages WHERE session_id = '...'`
2. **`list_projects` / `create_project` / `create_branch`**: –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º –ø—Ä–æ–µ–∫—Ç—ñ–≤.
   - *–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:* –ü—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É –≥—ñ–ª–∫—É –ë–î.
3. **`prepare_database_migration`**: –ó–º—ñ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø–∞–º'—è—Ç—ñ (–¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ç–∞–±–ª–∏—Ü—å/–∫–æ–ª–æ–Ω–æ–∫).

## üì• –ü—Ä–æ—Ç–æ–∫–æ–ª –ó–∞–ø–∏—Å—É (Append-Only)

### 1. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –°–µ—Å—ñ—ó
- –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è "—è–∫ —î" –≤ —Ç–∞–±–ª–∏—Ü—é `messages`.
- **–ü—Ä–∞–≤–∏–ª–æ:** –ù—ñ–∫–æ–ª–∏ –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ `content` –º–∏–Ω—É–ª–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

### 2. –¢–µ–º–ø–æ—Ä–∞–ª—å–Ω—ñ –§–∞–∫—Ç–∏ (–ì—Ä–∞—Ñ –ó–Ω–∞–Ω—å)
–ü—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Ñ–∞–∫—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–π—à–æ–≤ –Ω–∞ Python 3.11"):
1. –ó–Ω–∞–π—Ç–∏ —Å—Ç–∞—Ä–∏–π –∞–∫—Ç–∏–≤–Ω–∏–π —Ñ–∞–∫—Ç (`valid_to IS NULL`) –ø—Ä–æ –≤–µ—Ä—Å—ñ—é Python.
2. –í –æ–¥–Ω—ñ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó:
   - –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π —Ñ–∞–∫—Ç: –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `valid_to = NOW()`.
   - –í—Å—Ç–∞–≤–∏—Ç–∏ –Ω–æ–≤–∏–π —Ñ–∞–∫—Ç: `valid_from = NOW()`, `valid_to = NULL`.

## üì§ –ü—Ä–æ—Ç–æ–∫–æ–ª –ß–∏—Ç–∞–Ω–Ω—è (Context Retrieval)

### 1. "–•—Ç–æ —è —ñ –¥–µ —è?" (Context Awareness)
–ù–∞ –ø–æ—á–∞—Ç–∫—É —Å–µ—Å—ñ—ó –∞–≥–µ–Ω—Ç –ø–æ–≤–∏–Ω–µ–Ω:
1. –í–∏–∑–Ω–∞—á–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π –ø—Ä–æ–µ–∫—Ç.
2. –ó–Ω–∞–π—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –≥—ñ–ª–∫—É –≤ Neon (–∞–±–æ `main`, —è–∫—â–æ —Ü–µ –∑–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç).
3. –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –∞–∫—Ç–∏–≤–Ω—ñ —Ñ–∞–∫—Ç–∏ –∑ –ì—Ä–∞—Ñ—É –ó–Ω–∞–Ω—å (`WHERE valid_to IS NULL`).

### 2. –ü–æ—à—É–∫ (RAG)
–î–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç–∞–Ω—å:
1. –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –≤–µ–∫—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç (embedding) –∑ –ø–∏—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
2. –ó–Ω–∞–π—Ç–∏ —Ç–æ–ø-N —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ —ñ—Å—Ç–æ—Ä—ñ—ó (`ORDER BY embedding <=> query_embedding`).
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∑–Ω–∞–π–¥–µ–Ω–µ —è–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.

## ‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏
- **DELETE –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.** –î–∞–Ω—ñ –º–æ–∂–Ω–∞ —Ç—ñ–ª—å–∫–∏ "–∞—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏" (—Å—Ç–∞–≤–∏—Ç–∏ `valid_to`).
- **–ì—ñ–ª–∫–∏ —ñ–∑–æ–ª—å–æ–≤–∞–Ω—ñ.** –ù–µ –ø–∏—Å–∞—Ç–∏ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É –≤ `main` –≥—ñ–ª–∫—É.



