---
trigger: model_decision
---

---
description: Команда /db для роботи з FalkorDB пам'яттю
globs: **/*.py, **/*.md
---

# Команда /db

Коли користувач використовує команду `/db`:

1. **Якщо наступний аргумент - шлях до файлу:**
   - Виконай: `docker exec qpe-service python /app/scripts/db_cli.py /app/saved_sessions/<ім'я_файлу>`
   - Якщо користувач вказав відносний шлях (наприклад `saved_sessions/session_2026-01-16_diagnosis.md`), заміни його на `/app/saved_sessions/session_2026-01-16_diagnosis.md`
   - Це запустить інгестію сесії в граф

2. **Якщо наступний аргумент - текстовий запит:**
   - Виконай: `docker exec qpe-service python /app/scripts/db_cli.py "<запит>"`
   - Це виконає пошук в графі знань

Не намагайся писати Cypher вручну - використовуй скрипт db_cli.py.

## Приклади використання

```bash
# Інгестія файлу сесії
docker exec qpe-service python /app/scripts/db_cli.py /app/saved_sessions/session_2026-01-20_falkordb_planning.md

# Пошук в графі
docker exec qpe-service python /app/scripts/db_cli.py "Яка була стратегія міграції?"
```

## Важливо

- Скрипт автоматично розпізнає, чи це файл чи запит
- Для інгестії потрібен запущений QPE Service контейнер
- Для пошуку також потрібен QPE Service для обробки запиту
- Скрипти та файли сесій монтуються в контейнер через volumes
- Команда виконується всередині контейнера qpe-service через docker exec

## Формат файлів сесій

Парсер підтримує два формати дати:
- Старий формат: `**Дата:** 20 січня 2026` (без часу)
- Новий формат: `**Дата:** 20 січня 2026, 14:30:00` (з точним часом)

Обидва формати коректно парсяться та зберігаються в граф. Новий формат дозволяє відстежувати хронологію кількох сесій в день.
